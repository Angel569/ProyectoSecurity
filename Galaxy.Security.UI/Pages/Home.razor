@page "/"
@using Galaxy.Security.UI.Services
@using Microsoft.AspNetCore.Components.Authorization
@attribute [Authorize]
@inject HttpClient http
@inject AuthenticationStateProvider Auth
@inject NavigationManager Navegador
@inject IToastService ToastService
<PageTitle>Home</PageTitle>


<div class="button-container">
    <div class="btn" @onclick="GoToRegistroUsuario">
        <i class="bi bi-clipboard-check"></i>
        <span>Registrar Usuario</span>
    </div>
    <div class="btn">
        <i class="bi bi-clipboard2-pulse-fill"></i>
        <span>Menu 1</span>
    </div>
    <div class="btn">
        <i class="bi bi-bicycle"></i>
        <span>Menu 1</span>
    </div>
    <div class="btn">
        <i class="bi bi-heart-pulse"></i>
        <span>Menu 1</span>
    </div>
    <div class="btn">
        <i class="bi bi-person-raised-hand"></i>
        <span>Menu 1</span>
    </div>
    <div class="btn" @onclick="CerrarSesion">
        <i class="bi bi-door-open"></i>
        <span>Cerrar Sesión</span>
    </div>
</div>

@code {
    public void GoToRegistroUsuario()
    {
        Navegador.NavigateTo("/usuario/nuevo");
    }

    public async Task CerrarSesion()
    {
        try
        {
            var authService = (AuthenticationService)Auth;
            await authService.Logout();
            Navegador.NavigateTo("/");
        }
        catch (Exception ex)
        {
            Console.WriteLine($"Error en inicio de sesión: {ex.Message}");
            ToastService.ShowError("Ocurrió un error inesperado al iniciar sesión.");
        }
    }
}
